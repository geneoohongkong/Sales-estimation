<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSE Â· single linked box</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');
        body { font-family: 'Inter', sans-serif; background: #f4f7fb; display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 1rem; }
        .card { transition: all 0.15s ease; max-width: 480px; width: 100%; }
        .card:hover { transform: translateY(-3px); box-shadow: 0 20px 25px -5px rgba(0,0,0,0.05); }
        input[type="number"] { transition: all 0.15s; }
        input[type="number"]:focus { outline: none; ring: 2px solid #fbbf24; border-color: #f59e0b; }
        .metric-label { font-size: 0.875rem; color: #4b5563; }
    </style>
</head>
<body>
    <div class="card bg-white rounded-3xl shadow-md p-6 border border-gray-100">
        <!-- header with emoji and name -->
        <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-xl flex items-center justify-center text-xl bg-emerald-50 text-emerald-600">ðŸ“ž</div>
                <span class="font-semibold text-xl text-gray-800">CSE</span>
            </div>
            <div id="cse-badge" class="bg-gray-800 text-white text-sm font-mono px-5 py-2 rounded-2xl shadow-inner">
                4,838,400
            </div>
        </div>

        <!-- main funnel metrics -->
        <div class="space-y-4">
            <!-- Audience -->
            <div class="flex items-center justify-between">
                <span class="metric-label">Audience</span>
                <input type="number" id="cse-audience" value="2000" class="w-24 text-right bg-gray-50 border border-gray-200 rounded-2xl px-3 py-2 text-sm font-medium focus:border-amber-400">
            </div>
            <!-- Reach % -->
            <div class="flex items-center justify-between">
                <span class="metric-label">Reach %</span>
                <div class="flex items-center">
                    <input type="number" id="cse-reach" value="70" class="w-20 text-right bg-gray-50 border border-gray-200 rounded-2xl px-3 py-2 text-sm font-medium focus:border-amber-400">
                    <span class="text-gray-400 text-sm ml-1">%</span>
                </div>
            </div>
            <!-- Self act % -->
            <div class="flex items-center justify-between">
                <span class="metric-label">Self act %</span>
                <div class="flex items-center">
                    <input type="number" id="cse-selfAct" value="90" class="w-20 text-right bg-gray-50 border border-gray-200 rounded-2xl px-3 py-2 text-sm font-medium focus:border-amber-400">
                    <span class="text-gray-400 text-sm ml-1">%</span>
                </div>
            </div>
            <!-- Node act % -->
            <div class="flex items-center justify-between">
                <span class="metric-label">Node act %</span>
                <div class="flex items-center">
                    <input type="number" id="cse-nodeAct" value="90" class="w-20 text-right bg-gray-50 border border-gray-200 rounded-2xl px-3 py-2 text-sm font-medium focus:border-amber-400">
                    <span class="text-gray-400 text-sm ml-1">%</span>
                </div>
            </div>
            <!-- Show % -->
            <div class="flex items-center justify-between">
                <span class="metric-label">Show %</span>
                <div class="flex items-center">
                    <input type="number" id="cse-show" value="70" class="w-20 text-right bg-gray-50 border border-gray-200 rounded-2xl px-3 py-2 text-sm font-medium focus:border-amber-400">
                    <span class="text-gray-400 text-sm ml-1">%</span>
                </div>
            </div>
            <!-- Sign % -->
            <div class="flex items-center justify-between">
                <span class="metric-label">Sign %</span>
                <div class="flex items-center">
                    <input type="number" id="cse-sign" value="30" class="w-20 text-right bg-gray-50 border border-gray-200 rounded-2xl px-3 py-2 text-sm font-medium focus:border-amber-400">
                    <span class="text-gray-400 text-sm ml-1">%</span>
                </div>
            </div>
        </div>

        <!-- tail replication section -->
        <div class="mt-8 pt-5 border-t border-gray-100">
            <div class="text-[10px] font-mono tracking-wider text-amber-500 mb-4 flex items-center gap-1">
                <span>ðŸ“‹</span> TAIL REPLICATION
            </div>
            <div class="space-y-4">
                <!-- Tail book # -->
                <div class="flex items-center justify-between">
                    <span class="metric-label">Tail book #</span>
                    <input type="number" id="cse-tailBook" value="630" class="w-24 text-right bg-gray-50 border border-gray-200 rounded-2xl px-3 py-2 text-sm font-medium focus:border-amber-400">
                </div>
                <!-- Repl no. -->
                <div class="flex items-center justify-between">
                    <span class="metric-label">Repl no.</span>
                    <input type="number" id="cse-replNo" value="20" class="w-24 text-right bg-gray-50 border border-gray-200 rounded-2xl px-3 py-2 text-sm font-medium focus:border-amber-400">
                </div>
                <!-- Show tail % -->
                <div class="flex items-center justify-between">
                    <span class="metric-label">Show tail %</span>
                    <div class="flex items-center">
                        <input type="number" id="cse-tailShow" value="30" class="w-20 text-right bg-gray-50 border border-gray-200 rounded-2xl px-3 py-2 text-sm font-medium focus:border-amber-400">
                        <span class="text-gray-400 text-sm ml-1">%</span>
                    </div>
                </div>
                <!-- Sign tail % -->
                <div class="flex items-center justify-between">
                    <span class="metric-label">Sign tail %</span>
                    <div class="flex items-center">
                        <input type="number" id="cse-tailSign" value="20" class="w-20 text-right bg-gray-50 border border-gray-200 rounded-2xl px-3 py-2 text-sm font-medium focus:border-amber-400">
                        <span class="text-gray-400 text-sm ml-1">%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- sales field (editable but linked) -->
        <div class="mt-8 pt-5 border-t border-gray-100 flex items-center justify-between">
            <span class="flex items-center gap-2 text-base font-medium text-gray-700">
                <span class="text-2xl">ðŸ”¥</span> Sales
            </span>
            <input type="number" id="cse-sales" value="4838400" class="w-40 text-right font-mono text-2xl font-semibold bg-transparent border-b-2 border-gray-200 focus:border-amber-400 outline-none">
        </div>

        <!-- tiny footnote -->
        <div class="text-center text-xs text-gray-400 mt-6">
            change any number â€” sales recalculates automatically
        </div>
    </div>

    <script>
        (function() {
            // ----- original CSE values (used for ticket calculation) -----
            const original = {
                audience: 2000,
                reach: 70,
                nodeAct: 90,
                show: 70,
                sign: 30,
                tailBook: 630,
                replNo: 20,
                tailShow: 30,
                tailSign: 20,
                sales: 4838400
            };

            // ----- compute fixed ticket (sales per total signer) from original -----
            const origReached = original.audience * (original.reach / 100);
            const origMainSign = origReached * (original.nodeAct / 100) * (original.show / 100) * (original.sign / 100);
            const origTailSign = original.tailBook * original.replNo * (original.tailShow / 100) * (original.tailSign / 100);
            const origTotalSign = origMainSign + origTailSign;
            const ticket = origTotalSign > 0 ? original.sales / origTotalSign : 0;

            // ----- helper to get float value from input -----
            function getVal(id) {
                const el = document.getElementById(id);
                if (!el) return 0;
                const v = parseFloat(el.value);
                return isNaN(v) ? 0 : v;
            }

            // ----- update sales based on current inputs -----
            function updateSales() {
                const audience = getVal('cse-audience');
                const reach = getVal('cse-reach') / 100;
                const nodeAct = getVal('cse-nodeAct') / 100;
                const show = getVal('cse-show') / 100;
                const sign = getVal('cse-sign') / 100;
                const tailBook = getVal('cse-tailBook');
                const replNo = getVal('cse-replNo');
                const tailShow = getVal('cse-tailShow') / 100;
                const tailSign = getVal('cse-tailSign') / 100;

                // main funnel signers
                const reached = audience * reach;
                const mainSigners = reached * nodeAct * show * sign;

                // tail signers
                const tailSigners = tailBook * replNo * tailShow * tailSign;

                const totalSigners = mainSigners + tailSigners;
                const newSales = Math.round(totalSigners * ticket);

                // update sales input field
                const salesInput = document.getElementById('cse-sales');
                if (salesInput) salesInput.value = newSales;

                // update badge
                const badge = document.getElementById('cse-badge');
                if (badge) badge.innerText = newSales.toLocaleString();
            }

            // ----- attach listeners to all inputs except the sales field itself -----
            const inputs = [
                'cse-audience', 'cse-reach', 'cse-selfAct', 'cse-nodeAct', 'cse-show', 'cse-sign',
                'cse-tailBook', 'cse-replNo', 'cse-tailShow', 'cse-tailSign'
            ];
            inputs.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.addEventListener('input', updateSales);
            });

            // optional: allow manual sales edit (updates badge, no recalc)
            const salesEl = document.getElementById('cse-sales');
            if (salesEl) {
                salesEl.addEventListener('input', function() {
                    const val = parseFloat(this.value) || 0;
                    const badge = document.getElementById('cse-badge');
                    if (badge) badge.innerText = val.toLocaleString();
                });
            }

            // initial update to ensure badge matches sales field
            updateSales();
        })();
    </script>
</body>
</html>
