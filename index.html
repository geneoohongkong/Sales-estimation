<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Estimation Â· Clean Format</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: #f5f7fa;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            padding: 2rem;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            font-size: 2.2rem;
            font-weight: 600;
            color: #0b2b4f;
            margin-bottom: 2rem;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        /* Four columns grid */
        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }
        
        /* Channel card */
        .channel-card {
            background: white;
            border-radius: 20px;
            padding: 1.5rem 1.2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            border: 1px solid #e2e8f0;
        }
        
        .channel-header {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2563eb;
            text-align: center;
            margin-bottom: 1.2rem;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 0.5rem;
        }
        
        /* Two-column rows with aligned percentages */
        .row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.4rem 0;
            border-bottom: 1px dashed #d1ddeb;
            font-size: 0.95rem;
        }
        
        .label {
            color: #1e293b;
            font-weight: 500;
            width: 100px;
        }
        
        .input-percent {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            width: 120px;
            justify-content: flex-end;
        }
        
        .percent-sign {
            color: #64748b;
            font-size: 0.9rem;
            width: 15px;
        }
        
        input {
            width: 70px;
            padding: 0.25rem 0.4rem;
            border: 2px solid #d1ddeb;
            border-radius: 6px;
            text-align: right;
            font-weight: 600;
            font-size: 0.9rem;
        }
        input:focus {
            outline: none;
            border-color: #2563eb;
        }
        
        .value-display {
            font-weight: 600;
            color: #0f172a;
            min-width: 70px;
            text-align: right;
            background: #f1f5f9;
            padding: 0.2rem 0.6rem;
            border-radius: 16px;
        }
        
        .section-title {
            font-weight: 700;
            color: #475569;
            margin: 1rem 0 0.5rem 0;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .total-sign-row {
            margin-top: 0.8rem;
            padding-top: 0.5rem;
            border-top: 2px solid #94a3b8;
            font-weight: 700;
        }
        
        .sales-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 0.8rem;
            padding-top: 0.5rem;
            border-top: 2px solid #2563eb;
            font-weight: 700;
            color: #059669;
        }
        
        /* Overall Performance - more readable */
        .overall-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #0b2b4f;
            margin: 2rem 0 1rem 0;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 0.3rem;
        }
        
        .overall-container {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            border: 1px solid #e2e8f0;
            margin-bottom: 1.5rem;
        }
        
        .overall-grid {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr;
            gap: 2rem;
        }
        
        .overall-col {
            padding: 0 1rem;
        }
        
        .overall-col.middle {
            border-left: 2px solid #e2e8f0;
            border-right: 2px solid #e2e8f0;
        }
        
        .overall-header {
            font-weight: 700;
            color: #2563eb;
            font-size: 1.2rem;
            margin-bottom: 1.2rem;
            text-align: center;
        }
        
        .overall-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.6rem 0.5rem;
            border-bottom: 1px solid #f1f5f9;
            font-size: 1rem;
        }
        
        .overall-row.total-sign-row {
            border-top: 2px solid #2563eb;
            border-bottom: none;
            margin-top: 1rem;
            padding-top: 1rem;
            font-size: 1.2rem;
            font-weight: 700;
            color: #0b2b4f;
        }
        
        .overall-value {
            font-weight: 600;
            background: #f1f5f9;
            padding: 0.2rem 0.8rem;
            border-radius: 30px;
        }
        
        .overall-value.highlight {
            background: #2563eb20;
            color: #2563eb;
            font-weight: 700;
        }
        
        .total-sign-box {
            background: #0b2b4f;
            color: white;
            border-radius: 30px;
            padding: 0.8rem 1.5rem;
            text-align: center;
            font-size: 1.3rem;
            margin-top: 0.5rem;
        }
        .total-sign-number {
            font-size: 2rem;
            font-weight: 700;
            margin-left: 0.5rem;
        }
        
        .total-sales-box {
            background: linear-gradient(135deg, #0b2b4f 0%, #1e3f60 100%);
            color: white;
            border-radius: 30px;
            padding: 1.5rem 2.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.3rem;
            margin-top: 1.5rem;
            box-shadow: 0 10px 20px rgba(11, 43, 79, 0.2);
        }
        .total-sales-amount {
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        .reset-btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 0.5rem 1.5rem;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            margin-left: 1rem;
            font-size: 0.9rem;
        }
        .reset-btn:hover {
            background: #1d4ed8;
        }
        
        /* Special styling for AI Agent - no note */
        .no-note {
            /* No special styling needed */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            ðŸ“Š Sales Estimation
            <button class="reset-btn" onclick="resetToOriginal()">â†º Reset to Original</button>
        </h1>

        <!-- Four channels grid -->
        <div class="grid-4" id="channelGrid"></div>

        <!-- Overall Performance - More Readable -->
        <div class="overall-title">Overall Performance</div>
        <div class="overall-container">
            <div class="overall-grid">
                <!-- Node Activation Column -->
                <div class="overall-col">
                    <div class="overall-header">ðŸ“ˆ Node Activation</div>
                    <div class="overall-row">
                        <span>Head book</span>
                        <span class="overall-value" id="overallHeadBook">4,132</span>
                    </div>
                    <div class="overall-row">
                        <span>Show</span>
                        <span class="overall-value">70%</span>
                    </div>
                    <div class="overall-row">
                        <span>Sign</span>
                        <span class="overall-value">30%</span>
                    </div>
                </div>
                
                <!-- Node Replication Column -->
                <div class="overall-col middle">
                    <div class="overall-header">ðŸ”„ Node Replication</div>
                    <div class="overall-row">
                        <span>Tail book</span>
                        <span><span class="overall-value" id="overallTailBookPct">49</span>% <span class="overall-value" id="overallTailBook">2,022</span></span>
                    </div>
                    <div class="overall-row">
                        <span>Show</span>
                        <span>30% <span class="overall-value" id="overallTailShow">607</span></span>
                    </div>
                    <div class="overall-row">
                        <span>Sign</span>
                        <span>20% <span class="overall-value" id="overallTailSign">121</span></span>
                    </div>
                </div>
                
                <!-- Total Sign Column -->
                <div class="overall-col">
                    <div class="overall-header">ðŸŽ¯ Total Sign</div>
                    <div class="total-sign-box">
                        <span>=</span>
                        <span class="total-sign-number" id="overallTotalSign">989</span>
                    </div>
                    <div style="margin-top: 1rem; color: #64748b; font-size: 0.9rem; text-align: center;">
                        Combined across all channels
                    </div>
                </div>
            </div>
        </div>

        <!-- Total Sales -->
        <div class="total-sales-box">
            <span>ðŸ’° Total Sales (All Channels)</span>
            <span class="total-sales-amount" id="totalSalesAll">$15,823,104</span>
        </div>
    </div>

    <script>
        // Original data exactly matching image
        const originalData = [
            {   // Therapist (0)
                name: 'Therapist',
                audience: 3640,
                reach: 70,
                headBook: 70,
                headShow: 70,
                headSign: 30,
                tailBook: 50,
                tailShow: 30,
                tailSign: 20,
                ticketSize: 16000,
                expectedHeadBookAbs: 1784,
                expectedHeadShowAbs: 1249,
                expectedHeadSignAbs: 375,
                expectedTailBookAbs: 892,
                expectedTailShowAbs: 268,
                expectedTailSignAbs: 54,
                expectedTotalSign: 428,
                expectedSales: 6849024
            },
            {   // CSE (1)
                name: 'CSE',
                audience: 2000,
                reach: 70,
                headBook: 90,
                headShow: 70,
                headSign: 30,
                tailBook: 50,
                tailShow: 30,
                tailSign: 20,
                ticketSize: 16000,
                expectedHeadBookAbs: 1260,
                expectedHeadShowAbs: 882,
                expectedHeadSignAbs: 265,
                expectedTailBookAbs: 630,
                expectedTailShowAbs: 189,
                expectedTailSignAbs: 38,
                expectedTotalSign: 302,
                expectedSales: 4838400
            },
            {   // Call Centre (2)
                name: 'Call Centre',
                audience: 2200,
                reach: 20,
                headBook: 20,
                headShow: 70,
                headSign: 30,
                tailBook: 0,
                tailShow: 30,
                tailSign: 20,
                ticketSize: 16600,
                expectedHeadBookAbs: 88,
                expectedHeadShowAbs: 62,
                expectedHeadSignAbs: 18,
                expectedTailBookAbs: 0,
                expectedTailShowAbs: 0,
                expectedTailSignAbs: 0,
                expectedTotalSign: 18,
                expectedSales: 295680
            },
            {   // AI Agent (3)
                name: 'AI Agent',
                audience: 100000,
                reach: 10,
                headBook: 10,
                headShow: 700,        // Absolute
                headSign: 210,         // Absolute
                tailBook: 50,
                tailShow: 150,         // Absolute
                tailSign: 30,          // Absolute
                ticketSize: 16000,
                expectedHeadBookAbs: 1000,
                expectedHeadShowAbs: 700,
                expectedHeadSignAbs: 210,
                expectedTailBookAbs: 500,
                expectedTailShowAbs: 150,
                expectedTailSignAbs: 30,
                expectedTotalSign: 240,
                expectedSales: 3840000
            }
        ];

        let channels = JSON.parse(JSON.stringify(originalData));

        // Calculate channel metrics
        function calculateChannel(ch, idx) {
            const isAI = (idx === 3);
            
            // Reached audience
            const reached = Math.round(ch.audience * (ch.reach / 100));
            
            // Head book
            const headBook = Math.round(reached * (ch.headBook / 100));
            
            // Head show
            let headShow;
            if (isAI) {
                headShow = ch.headShow;
            } else {
                headShow = Math.round(headBook * (ch.headShow / 100));
            }
            
            // Head sign
            let headSign;
            if (isAI) {
                headSign = ch.headSign;
            } else {
                headSign = Math.round(headShow * (ch.headSign / 100));
            }
            
            // Tail book = Head book Ã— (Tail book % / 100)
            const tailBook = Math.round(headBook * (ch.tailBook / 100));
            
            // Tail show
            let tailShow;
            if (isAI) {
                tailShow = ch.tailShow;
            } else {
                tailShow = Math.round(tailBook * (ch.tailShow / 100));
            }
            
            // Tail sign
            let tailSign;
            if (isAI) {
                tailSign = ch.tailSign;
            } else {
                tailSign = Math.round(tailShow * (ch.tailSign / 100));
            }
            
            // Total sign
            const totalSign = headSign + tailSign;
            
            // Sales
            const sales = Math.round(totalSign * ch.ticketSize);
            
            return {
                reached,
                headBook,
                headShow,
                headSign,
                tailBook,
                tailShow,
                tailSign,
                totalSign,
                sales
            };
        }

        // Calculate totals
        function calculateTotals() {
            let headBookSum = 0, headShowSum = 0, headSignSum = 0;
            let tailBookSum = 0, tailShowSum = 0, tailSignSum = 0;
            let totalSignSum = 0, totalSalesSum = 0;
            
            channels.forEach((ch, idx) => {
                const calc = calculateChannel(ch, idx);
                headBookSum += calc.headBook;
                headShowSum += calc.headShow;
                headSignSum += calc.headSign;
                tailBookSum += calc.tailBook;
                tailShowSum += calc.tailShow;
                tailSignSum += calc.tailSign;
                totalSignSum += calc.totalSign;
                totalSalesSum += calc.sales;
            });
            
            const tailBookPct = headBookSum > 0 ? Math.round((tailBookSum / headBookSum) * 100) : 0;
            
            return {
                headBook: headBookSum,
                headShow: headShowSum,
                headSign: headSignSum,
                tailBook: tailBookSum,
                tailShow: tailShowSum,
                tailSign: tailSignSum,
                totalSign: totalSignSum,
                totalSales: totalSalesSum,
                tailBookPct: tailBookPct
            };
        }

        // Build dashboard
        function buildDashboard() {
            const grid = document.getElementById('channelGrid');
            let html = '';
            
            // Channel cards
            channels.forEach((ch, idx) => {
                const calc = calculateChannel(ch, idx);
                const isAI = (idx === 3);
                
                html += `
                <div class="channel-card">
                    <div class="channel-header">${ch.name}</div>
                    
                    <!-- Audience - only one input -->
                    <div class="row">
                        <span class="label">Audience</span>
                        <div class="input-percent">
                            <input type="number" id="audience-${idx}" value="${ch.audience}" step="1" min="0" onchange="updateChannel(${idx})">
                            <span class="value-display">${ch.audience.toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <!-- Reach with % sign -->
                    <div class="row">
                        <span class="label">Reach</span>
                        <div class="input-percent">
                            <input type="number" id="reach-${idx}" value="${ch.reach}" step="1" min="0" max="100" onchange="updateChannel(${idx})">
                            <span class="percent-sign">%</span>
                            <span class="value-display">${calc.reached.toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <div class="section-title">Node activation</div>
                    
                    <!-- Head book with % sign -->
                    <div class="row">
                        <span class="label">Head book</span>
                        <div class="input-percent">
                            <input type="number" id="headBook-${idx}" value="${ch.headBook}" step="1" min="0" max="100" onchange="updateChannel(${idx})">
                            <span class="percent-sign">%</span>
                            <span class="value-display">${calc.headBook.toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <!-- Show - with % for non-AI, no % for AI -->
                    <div class="row">
                        <span class="label">Show</span>
                        <div class="input-percent">
                            <input type="number" id="headShow-${idx}" value="${ch.headShow}" step="1" min="0" ${!isAI ? 'max="100"' : ''} onchange="updateChannel(${idx})">
                            ${!isAI ? '<span class="percent-sign">%</span>' : '<span class="percent-sign"></span>'}
                            <span class="value-display">${calc.headShow.toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <!-- Sign - with % for non-AI, no % for AI -->
                    <div class="row">
                        <span class="label">Sign</span>
                        <div class="input-percent">
                            <input type="number" id="headSign-${idx}" value="${ch.headSign}" step="1" min="0" ${!isAI ? 'max="100"' : ''} onchange="updateChannel(${idx})">
                            ${!isAI ? '<span class="percent-sign">%</span>' : '<span class="percent-sign"></span>'}
                            <span class="value-display">${calc.headSign.toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <div class="section-title">Node Replication</div>
                    
                    <!-- Tail book with % sign -->
                    <div class="row">
                        <span class="label">Tail book</span>
                        <div class="input-percent">
                            <input type="number" id="tailBook-${idx}" value="${ch.tailBook}" step="1" min="0" max="100" onchange="updateChannel(${idx})">
                            <span class="percent-sign">%</span>
                            <span class="value-display">${calc.tailBook.toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <!-- Tail Show - with % for non-AI, no % for AI -->
                    <div class="row">
                        <span class="label">Show</span>
                        <div class="input-percent">
                            <input type="number" id="tailShow-${idx}" value="${ch.tailShow}" step="1" min="0" ${!isAI ? 'max="100"' : ''} onchange="updateChannel(${idx})">
                            ${!isAI ? '<span class="percent-sign">%</span>' : '<span class="percent-sign"></span>'}
                            <span class="value-display">${calc.tailShow.toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <!-- Tail Sign - with % for non-AI, no % for AI -->
                    <div class="row">
                        <span class="label">Sign</span>
                        <div class="input-percent">
                            <input type="number" id="tailSign-${idx}" value="${ch.tailSign}" step="1" min="0" ${!isAI ? 'max="100"' : ''} onchange="updateChannel(${idx})">
                            ${!isAI ? '<span class="percent-sign">%</span>' : '<span class="percent-sign"></span>'}
                            <span class="value-display">${calc.tailSign.toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <!-- Total sign -->
                    <div class="row total-sign-row">
                        <span class="label">Total sign</span>
                        <span class="value-display" id="totalSign-${idx}">${calc.totalSign.toLocaleString()}</span>
                    </div>
                    
                    <!-- Ticket size -->
                    <div class="row">
                        <span class="label">Avg ticket size</span>
                        <div class="input-percent">
                            <span>$</span>
                            <input type="number" id="ticket-${idx}" value="${ch.ticketSize}" step="500" min="0" onchange="updateChannel(${idx})" style="width:80px;">
                        </div>
                    </div>
                    
                    <!-- Sales -->
                    <div class="sales-row">
                        <span class="label">Sales</span>
                        <span class="value-display" id="sales-${idx}" style="background: #05966920; color: #059669; font-weight: 700;">$${calc.sales.toLocaleString()}</span>
                    </div>
                </div>
                `;
            });
            
            grid.innerHTML = html;
            
            // Update overall
            const totals = calculateTotals();
            document.getElementById('overallHeadBook').innerText = totals.headBook.toLocaleString();
            document.getElementById('overallTailBook').innerText = totals.tailBook.toLocaleString();
            document.getElementById('overallTailBookPct').innerText = totals.tailBookPct;
            document.getElementById('overallTailShow').innerText = totals.tailShow.toLocaleString();
            document.getElementById('overallTailSign').innerText = totals.tailSign.toLocaleString();
            document.getElementById('overallTotalSign').innerText = totals.totalSign.toLocaleString();
            document.getElementById('totalSalesAll').innerText = '$' + totals.totalSales.toLocaleString();
        }

        // Update channel
        window.updateChannel = function(idx) {
            channels[idx].audience = parseFloat(document.getElementById(`audience-${idx}`).value) || 0;
            channels[idx].reach = parseFloat(document.getElementById(`reach-${idx}`).value) || 0;
            channels[idx].headBook = parseFloat(document.getElementById(`headBook-${idx}`).value) || 0;
            channels[idx].headShow = parseFloat(document.getElementById(`headShow-${idx}`).value) || 0;
            channels[idx].headSign = parseFloat(document.getElementById(`headSign-${idx}`).value) || 0;
            channels[idx].tailBook = parseFloat(document.getElementById(`tailBook-${idx}`).value) || 0;
            channels[idx].tailShow = parseFloat(document.getElementById(`tailShow-${idx}`).value) || 0;
            channels[idx].tailSign = parseFloat(document.getElementById(`tailSign-${idx}`).value) || 0;
            channels[idx].ticketSize = parseFloat(document.getElementById(`ticket-${idx}`).value) || 0;
            
            buildDashboard();
        };

        // Reset
        window.resetToOriginal = function() {
            channels = JSON.parse(JSON.stringify(originalData));
            buildDashboard();
        };

        // Initialize
        buildDashboard();
    </script>
</body>
</html>
